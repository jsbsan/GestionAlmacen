' Gambas class file

PUBLIC SUB Form_Open()
 Titulos.tituloFfiltroProveedorFactura()
  BorradosDatosIniciales.dibujogrid11()
END

PUBLIC SUB TextBox1_KeyPress()

  IF Key.code = Key.enter OR Key.code = Key.Return OR Key.CODE = Key.TAB THEN 
  Button1.SetFocus
  END IF

END

PUBLIC SUB GridView1_Click()
 Button2_Click()
END

PUBLIC SUB Button2_Click()
IF gridview1.row <> -1 THEN 

 FMain.ComboBoxProvFact.TEXT = gridview1[GridView1.row, 1].text
 'correccion 
 END IF
 
ME.Close
END

PUBLIC SUB Button3_Click()
  ME.Close
END

PUBLIC SUB GridView1_ColumnClick(Column AS Integer)

    IF var.ordenfiltroProveedorFactura = 0 THEN 
  OrdenacionGridview.ord_AZ(GridView1, Column)
  var.ordenfiltroProveedorFactura = 1
  ELSE 
  var.ordenfiltroProveedorFactura = 0
  OrdenacionGridview.ord_ZA(GridView1, Column)
ENDIF 


END

PUBLIC SUB Button1_Click()

  DIM resultado AS Integer
resultado = buscar.ProveedorFiltrofacturas(Upper(TextBox1.text), CheckBoxFiltroProveedorfm.Value)
IF RESULTADO = 1 THEN 
    GridView1.Background = Color.Cyan
    ELSE 
    GridView1.Background = Color.White
  END IF
  
TextBox1.SetFocus

END
