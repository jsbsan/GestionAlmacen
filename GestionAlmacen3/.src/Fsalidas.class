' Gambas class file

Public Sub Form_Open()
  'se debe rellanar las entradas del concepto elegido....

  rellena_salida(var.conceptosalida)

End

'-----------------------------------------------------------------
'subrutinas
'-----------------------------------------------------------------

Sub rellena_salida(idconcepto As String)

  Dim c As Integer
  Dim numero As Integer

  Titulos.fgridsalidas() 'vuelvo a definir como es la grid de salidas

  For c = 0 To var.entrada_numero - 1
    If var.entrada_idconcepto[c] <> "IdB" And idconcepto = var.entrada_idconcepto[c] And (var.entrada_medidaconcepto[c] - var.entrada_salida[c]) <> 0 Then
      'dibujo en el gridw
      numero += 1
      GridViewS.Rows.count = numero
      GridViewS[numero - 1, 0].text = var.entrada_idconcepto[c]
      GridViewS[numero - 1, 1].text = buscar.buscaprov(var.entrada_id[c])
      GridViewS[numero - 1, 2].text = buscar.buscaUd(var.entrada_idconcepto[c])
      GridViewS[numero - 1, 3].text = buscar.buscaDenoConcepto(var.entrada_idconcepto[c])
      Gridviews[numero - 1, 4].text = var.entrada_precio[c]
      Gridviews[numero - 1, 5].text = var.entrada_medidaconcepto[c]
      Gridviews[numero - 1, 6].text = var.entrada_salida[c]
      Gridviews[numero - 1, 7].text = var.entrada_medidaconcepto[c] - var.entrada_salida[c]
      GridViewS[numero - 1, 8].text = Str$(c)
    Endif
  Next

End

Public Sub GridViewS_Click()

  var.salir = Val(GridViewS[GridViewS.row, 8].text)

  FCuantoSale.ShowModal

  'pide la salida
  'dando recomendaciones:
  ' todo
  ' lo que sale
  'lo que debe de quedar
  ' y luego debe de grabar en ver.entrada_salida, el dato. y redibujar el grid

  rellena_salida(var.conceptosalida)

End

Public Sub Button1_Click()

  Me.close

End

Public Sub GridViewS_ColumnClick(Column As Integer)

  If var.ordensalidas = 0 Then
    OrdenacionGridview.ord_AZ(GridViewS, Column)
    var.ordensalidas = 1
  Else
    var.ordensalidas = 0
    OrdenacionGridview.ord_ZA(GridViewS, Column)
  Endif

End
